<script lang="ts">
  import { cubicOut } from "svelte/easing";
  import type { TransitionConfig } from "svelte/types/runtime/transition";

  let isDark = false;
  if (
    window.matchMedia &&
    window.matchMedia("(prefers-color-scheme: dark)").matches
  ) {
    isDark = true;
  }

  $: {
    const theme = isDark ? "dark" : "light";
    document.documentElement.setAttribute("data-theme", theme);
  }

  function spin(
    node: Element,
    { clockwise, duration }: { clockwise: boolean; duration: number },
  ): TransitionConfig {
    return {
      duration,
      css: (t: number): string => {
        const eased = cubicOut(t);
        const degree = clockwise ? 180 : -180;

        return `
        transform: scale(${eased}) rotate(${(1 - eased) * degree}deg);`;
      },
    };
  }
</script>

<div>
  <button
    role="switch"
    class="w-10 h-10 rounded-full hover:bg-base-200"
    on:click={() => (isDark = !isDark)}
  >
    {#if isDark}
      <svg
        in:spin={{ clockwise: true, duration: 500 }}
        class="block m-auto fill-current"
        width="24px"
        height="24px"
        viewBox="0 0 24 24"
        ><path
          d="M12.3 22h-.1a10.31 10.31 0 0 1-7.34-3.15 10.46 10.46 0 0 1-.26-14 10.13 10.13 0 0 1 4-2.74 1 1 0 0 1 1.06.22 1 1 0 0 1 .24 1 8.4 8.4 0 0 0 1.94 8.81 8.47 8.47 0 0 0 8.83 1.94 1 1 0 0 1 1.27 1.29A10.16 10.16 0 0 1 19.6 19a10.28 10.28 0 0 1-7.3 3z"
        /></svg
      >
    {:else}
      <svg
        in:spin={{ clockwise: false, duration: 500 }}
        class="block m-auto fill-current"
        width="24px"
        height="24px"
        viewBox="0 0 24 24"
      >
        <path
          d="M 17.300781 12 C 17.300781 14.929688 14.929688 17.300781 12 17.300781 C 9.070312 17.300781 6.699219 14.929688 6.699219 12 C 6.699219 9.070312 9.070312 6.699219 12 6.699219 C 14.929688 6.699219 17.300781 9.070312 17.300781 12 Z M 17.300781 12 "
        />
        <path
          d="M 12 18.167969 C 8.597656 18.167969 5.832031 15.402344 5.832031 12 C 5.832031 8.597656 8.597656 5.832031 12 5.832031 C 15.402344 5.832031 18.167969 8.597656 18.167969 12 C 18.167969 15.402344 15.402344 18.167969 12 18.167969 Z M 12 7.566406 C 9.554688 7.566406 7.566406 9.554688 7.566406 12 C 7.566406 14.445312 9.554688 16.433594 12 16.433594 C 14.445312 16.433594 16.433594 14.445312 16.433594 12 C 16.433594 9.554688 14.445312 7.566406 12 7.566406 Z M 12 7.566406 "
        />
        <path
          d="M 12 4.550781 C 11.519531 4.550781 11.132812 4.164062 11.132812 3.6875 L 11.132812 0.867188 C 11.132812 0.386719 11.519531 0 12 0 C 12.480469 0 12.867188 0.386719 12.867188 0.867188 L 12.867188 3.6875 C 12.867188 4.164062 12.480469 4.550781 12 4.550781 Z M 12 4.550781 "
        />
        <path
          d="M 12 24 C 11.519531 24 11.132812 23.613281 11.132812 23.132812 L 11.132812 20.3125 C 11.132812 19.835938 11.519531 19.449219 12 19.449219 C 12.480469 19.449219 12.867188 19.835938 12.867188 20.3125 L 12.867188 23.132812 C 12.867188 23.613281 12.480469 24 12 24 Z M 12 24 "
        />
        <path
          d="M 23.132812 12.867188 L 20.3125 12.867188 C 19.835938 12.867188 19.449219 12.480469 19.449219 12 C 19.449219 11.519531 19.835938 11.132812 20.3125 11.132812 L 23.132812 11.132812 C 23.613281 11.132812 24 11.519531 24 12 C 24 12.480469 23.613281 12.867188 23.132812 12.867188 Z M 23.132812 12.867188 "
        />
        <path
          d="M 3.6875 12.867188 L 0.867188 12.867188 C 0.386719 12.867188 0 12.480469 0 12 C 0 11.519531 0.386719 11.132812 0.867188 11.132812 L 3.6875 11.132812 C 4.164062 11.132812 4.550781 11.519531 4.550781 12 C 4.550781 12.480469 4.164062 12.867188 3.6875 12.867188 Z M 3.6875 12.867188 "
        />
        <path
          d="M 17.878906 6.988281 C 17.65625 6.988281 17.433594 6.902344 17.265625 6.734375 C 16.925781 6.394531 16.925781 5.847656 17.265625 5.507812 L 19.257812 3.515625 C 19.597656 3.175781 20.148438 3.175781 20.484375 3.515625 C 20.824219 3.851562 20.824219 4.402344 20.484375 4.742188 L 18.492188 6.734375 C 18.324219 6.902344 18.101562 6.988281 17.878906 6.988281 Z M 17.878906 6.988281 "
        />
        <path
          d="M 4.128906 20.738281 C 3.90625 20.738281 3.683594 20.65625 3.515625 20.484375 C 3.175781 20.148438 3.175781 19.597656 3.515625 19.257812 L 5.507812 17.265625 C 5.847656 16.925781 6.394531 16.925781 6.734375 17.265625 C 7.074219 17.605469 7.074219 18.152344 6.734375 18.492188 L 4.742188 20.484375 C 4.570312 20.65625 4.347656 20.738281 4.128906 20.738281 Z M 4.128906 20.738281 "
        />
        <path
          d="M 19.871094 20.738281 C 19.652344 20.738281 19.429688 20.65625 19.257812 20.484375 L 17.265625 18.492188 C 16.925781 18.152344 16.925781 17.605469 17.265625 17.265625 C 17.605469 16.925781 18.152344 16.925781 18.492188 17.265625 L 20.484375 19.257812 C 20.824219 19.597656 20.824219 20.148438 20.484375 20.484375 C 20.316406 20.65625 20.09375 20.738281 19.871094 20.738281 Z M 19.871094 20.738281 "
        />
        <path
          d="M 6.121094 6.988281 C 5.898438 6.988281 5.675781 6.902344 5.507812 6.734375 L 3.515625 4.742188 C 3.175781 4.402344 3.175781 3.851562 3.515625 3.515625 C 3.851562 3.175781 4.402344 3.175781 4.742188 3.515625 L 6.734375 5.507812 C 7.074219 5.847656 7.074219 6.394531 6.734375 6.734375 C 6.566406 6.902344 6.34375 6.988281 6.121094 6.988281 Z M 6.121094 6.988281 "
        />
      </svg>
    {/if}
  </button>
</div>
